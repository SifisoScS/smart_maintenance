@page "/test"
@inject HttpClient Http

<PageTitle>Connection Test</PageTitle>

<h3>Backend Connection Test</h3>

<button class="btn btn-primary" @onclick="TestConnection">Test Backend Connection</button>

<div style="margin-top: 20px;">
    <h4>Result:</h4>
    <pre>@result</pre>
</div>

@code {
    private string result = "Click the button to test...";

    private async Task TestConnection()
    {
        result = "Testing...";
        try
        {
            // Use RELATIVE URL since HttpClient has BaseAddress configured
            var response = await Http.GetAsync("/api/v1/health");
            result = $"Status: {response.StatusCode}\n";
            result += $"Success: {response.IsSuccessStatusCode}\n";
            result += $"Content: {await response.Content.ReadAsStringAsync()}";
        }
        catch (Exception ex)
        {
            result = $"ERROR: {ex.GetType().Name}\n{ex.Message}\n\nStack: {ex.StackTrace}";
        }
    }
}

<style>
    .btn {
        padding: 10px 20px;
        background-color: #4f46e5;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }

    .btn:hover {
        background-color: #4338ca;
    }

    pre {
        background: #f5f5f5;
        padding: 15px;
        border-radius: 6px;
        overflow-x: auto;
    }
</style>
